[Unit]
After=docker.service
Requires=docker.service
PartOf=docker.service
After=etcd_container.service
Wants=etcd_container.service

[Service]
EnvironmentFile=/etc/sysconfig/atomic-openshift-master
ExecStartPre=-/usr/bin/docker rm -f atomic-openshift-master
ExecStart=/usr/bin/docker run --rm --privileged --net=host --name atomic-openshift-master --env-file=/etc/sysconfig/atomic-openshift-master -v <%= node['is_apaas_openshift_cookbook']['openshift_data_dir'] %>:<%= node['is_apaas_openshift_cookbook']['openshift_data_dir'] %> -v /var/run/docker.sock:/var/run/docker.sock -v <%= node['is_apaas_openshift_cookbook']['openshift_common_base_dir'] %>:<%= node['is_apaas_openshift_cookbook']['openshift_common_base_dir'] %> <%= node['is_apaas_openshift_cookbook']['openshift_docker_master_image'] %>:${IMAGE_VERSION} start master --config=${CONFIG_FILE} $OPTIONS
ExecStartPost=/usr/bin/sleep 10
ExecStop=/usr/bin/docker stop atomic-openshift-master
Restart=always
RestartSec=5s

[Install]
WantedBy=docker.service

